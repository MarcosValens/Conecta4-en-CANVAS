<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<canvas id="conect4" width="700" height="600"></canvas>
<script>
    var canvas = document.querySelector('#conect4');
    var c = canvas.getContext('2d');
    var cont = 0;
    var filaT = 6;
    var columnaT = 7;
    var turno = 0;
    var tablero = [];
    for (var i = 0; i < (canvas.width+100)/100; i++) {
        c.moveTo(0, cont);
        c.lineTo(columnaT*100, cont);
        cont = cont + 100;
        c.strokeStyle="blue";
    }
    cont = 0;
    for (var j = 0; j < (canvas.width+100)/100; j++) {
        c.moveTo(cont, 0);
        c.lineTo(cont, filaT*100);
        cont = cont + 100;
    }
    var height = 50;
    var width = 50;
    c.stroke();
    for (var k = 0; k < columnaT; k++) {
        for (var l = 0; l < filaT; l++) {
            c.fillStyle = "white";
            c.beginPath();
            c.arc(width, height, 50, 0, 2 * Math.PI);
            height = height + 100;
            c.fill();
            c.stroke();
        }
        height = 50;
        c.beginPath();
        c.arc(width, height, 50, 0, 2 * Math.PI);
        width = width + 100;
        c.stroke();
    }

    function Ficha(width, height,color) {
        this.width = width;
        this.pintar = function(){
            c.fillStyle = color;
            c.beginPath();
            c.arc(width,height,50,0,2*Math.PI);
            c.fill();
            c.stroke();}

    }

    canvas.addEventListener('click',function(event){
        turno++;
        var fila = 550;
        var columna = Math.ceil(event.clientX/100);
        var color;
        //DEFINICION DE COLOR PARA LAS FICHAS
        if (turno % 2 === 0){
            color = 1
        } else color = 2;
        //MIRAR EN QUE FILA VA LA FICHA
        if (tablero.length > 0){
            for (var i = 0; i < tablero.length; i++){
                if (columna === tablero[i].columna){
                    fila-=100;
                }
            }
        }
        var Fichas = new FICHAS_TABLERO(fila,columna,color);
        if (turno % 2 === 0){
            var f1 = new Ficha((columna*100)-50,fila,'red');
            f1.pintar();
        } else {
            var f2 = new Ficha((columna*100)-50,fila,'blue');
            f2.pintar();
        }
        tablero.push(Fichas);
        comprueba(tablero,Fichas);
    });

    function FICHAS_TABLERO(fila,columna,color){
        this.fila = fila;
        this.columna = columna;
        this.color = color;
    }
    function comprueba(tablero,Fichas){
        var linea = 0;
        //comprueba horizontal
        for (var i = 0; i < tablero.length; i++){
            if (tablero[i].fila === Fichas.fila && tablero[i].color === Fichas.color){
                linea++;
            }
            if (tablero[i].fila === Fichas.fila && tablero[i].color !== Fichas.color){
                linea = 0;
            }
            if (linea===4){
                alert("Has ganado")
            }
        }
        linea = 0;
        //comprueba vertical
        for (var j = 0; j < tablero.length; j++){
            if (tablero[j].columna === Fichas.columna && tablero[j].color === Fichas.color){
                linea++;
            }
            if (tablero[j].columna === Fichas.columna && tablero[j].color !== Fichas.color){
                linea = 0;
            }
            if (linea===4){
                alert("Has ganado")
            }
        }
        linea = 0;
        var diagonal = 100;
        //comprueba diagonal
        for (var k = 0; k < tablero.length; k++){
            if (tablero[k].fila === Fichas.fila - diagonal && tablero[k].columna - 1 === Fichas.columna &&tablero[k].color === Fichas.color){
                linea++;
            }
            if (tablero[k].columna+1 === Fichas.columna && tablero[k].color !== Fichas.color){
                linea = 0;
            }
            if (linea===4){
                alert("Has ganado")
            }
        }
    }
</script>
</body>
</html>